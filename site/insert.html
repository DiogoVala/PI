<!DOCTYPE html>
<html>
    <head>
        <meta content="text/html; charset=utf-8" http-equiv="Content-Type" />
        <title>Controlo Heatband</title>
        <link rel="stylesheet" href="style.css">    <!-- isto é para ligar ao ficheiro CSS -->
    </head>

    <body>
        <!-- "Cabeçalho" -->
        <div class="row" id="row1" style="z-index: -1;">
            <div class="left_box">
                <img src="azevedos1.png" alt="Azevedos"></div>
            <div class="middle_box">
                <h1 id="title_h1">Termorregulador digital</h1></div>
            <div class="right_box">
                <img src="logo.png" alt="UA">
            </div>
        </div>
        
        <!-- Restante body -->
        <br>

        <div class="wrapper" id="row2">
            <br><br><br>
            <div class="sidebar">
                <ul >
                    <b>
                        <li><a href="insert.html"><i class="fas fa-home"></i>Inserir par&acircmetros</a></li>
                        <li><a href="graf1.html"><i class="fas fa-user"></i>Temperatura</a></li>
                        <li><a href="graf2.html"><i class="fas fa-address-card"></i>Tens&atildeo</a></li>
                        <li><a href="graf3.html"><i class="fas fa-project-diagram"></i>Corrente</a></li>
                    </b>
                </ul> 
            </div>
            
            <div class="main_content">
                <div class="header">
                    <h1>Inserir par&acircmetros</h1> 
                </div> 

                <div class="info">
                    <form class="form" id="myForm" >
                        <label for="preheat" style="color: black;">Pr&eacute-aquecimento (&degC): </label>
                        <input type="text" id="preheat" name="preheat">
                        <button onclick="send_preheat()" type="submit">Enviar Valor</button>
                        <br>
                        <label for="seal" style="color: black;">Selagem (&degC):</label>
                        <input type="text" id="seal" name="seal">
                        <button onclick="send_seal()" type="submit">Enviar Valor</button>
                    </form>

                    <script>
                        var ip = String(get_ip());
                        function send_preheat(){
                            var preheat_value = document.getElementById("preheat").value;
                            submitOK = "true";
                            
                            if (isNaN(preheat_value) || preheat_value < 0 || preheat_value.length ==0) {
                                alert("A temperatura deve ser um valor positivo");
                                submitOK = "false";
                            }
                            
                            var protocol = "http://";
                            //var ip = String(get_ip());

                            var data = String(protocol)+ip+String("/set_temp_preheat?")+String(preheat_value)
                            
                            if (submitOK == "false") {
                                return false;
                            }else{
                                fetch(data)
                            }
                            
                        }

                        function send_seal(){
                            var seal_value = document.getElementById("seal").value;
                            submitOK = "true";
                            
                            if (isNaN(seal_value) || seal_value < 0 || seal_value.length ==0) {
                                alert("A temperatura deve ser um valor positivo");
                                submitOK = "false";
                            }

                            var protocol = "http://";
                            //var ip = String("192.168.169");
                                                     
                            var data = String(protocol)+ip+String("/set_temp_seal?")+String(seal_value)

                            if (submitOK == "false") {
                                return false;
                            }else{
                                fetch(data)
                            }
                        }

                        function get_ip(){
                            const fs = require('fs')
  
                            fs.readFile('IP_config.txt', 'utf-8', (err, data) => {
                                if (err) throw err;
                                
                                console.log(data);
                                //return data;
                            })
                        }

                    </script>
                </div>
            </div>
        </div>        
    </body>
</html>